<!--  D:\PROJETOS\GraphFacil\Dashboard\MainWindow.xaml  -->
<Window
    x:Class="Dashboard.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Dashboard.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Dashboard.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    Width="1080"
    Height="700"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d"
    >

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--  Material Design Resources  -->
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Button.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MaterialDesignThemes.Wpf;component/Themes/MaterialDesignTheme.Card.xaml" />

                <!--  Phase 1 Resources  -->
                <ResourceDictionary Source="Resources/Phase1Resources.xaml" />
                <ResourceDictionary Source="Resources/Phase1Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <!--  Local Converters  -->
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <!--  Background Gradient  -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0" Color="#FF2E3440" />
                <GradientStop Offset="0.5" Color="#FF3B4252" />
                <GradientStop Offset="1" Color="#FF434C5E" />
            </LinearGradientBrush>
        </Grid.Background>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="200" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  ==================================  -->
        <!--  BARRA DE TÍTULO  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="0"
            Grid.ColumnSpan="3"
            Background="#FF1A252F"
            MouseLeftButtonDown="TitleBar_MouseLeftButtonDown"
            >
            <Grid>
                <StackPanel
                    Margin="15,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    >
                    <md:PackIcon
                        Margin="0,0,10,0"
                        VerticalAlignment="Center"
                        Foreground="#FF3B82F6"
                        Kind="Analytics"
                        />
                    <TextBlock
                        VerticalAlignment="Center"
                        FontWeight="SemiBold"
                        Foreground="White"
                        Text="Sistema de Metrônomos Lotofácil v2.0 - Fase 1"
                        />
                </StackPanel>

                <StackPanel
                    Margin="15,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    >
                    <Button
                        x:Name="BtnMinimize"
                        Width="30"
                        Height="25"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="BtnMinimize_Click"
                        Content="−"
                        Foreground="White"
                        />
                    <Button
                        x:Name="BtnClose"
                        Width="30"
                        Height="25"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="BtnClose_Click"
                        Content="×"
                        Foreground="White"
                        />
                </StackPanel>
            </Grid>
        </Border>

        <!--  ==================================  -->
        <!--  PAINEL ESQUERDO - AÇÕES PRINCIPAIS  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="0"
            Margin="10,10,5,10"
            Background="{StaticResource SecondaryBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="8"
            >

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">

                    <!--  Título da Seção  -->
                    <TextBlock
                        Margin="0,0,0,15"
                        HorizontalAlignment="Center"
                        FontSize="14"
                        FontWeight="Bold"
                        Foreground="{StaticResource PrimaryTextBrush}"
                        Text="🎯 AÇÕES PRINCIPAIS"
                        />

                    <!--  Botões Originais  -->
                    <Button
                        Margin="0,0,0,5"
                        Command="{Binding PrimeiroCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="Play" />
                            <TextBlock Text="PRIMEIRO" />
                        </StackPanel>
                    </Button>

                    <Button
                        Margin="0,0,0,5"
                        Command="{Binding SegundoCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="Settings" />
                            <TextBlock Text="SEGUNDO" />
                        </StackPanel>
                    </Button>

                    <Button
                        Margin="0,0,0,5"
                        Command="{Binding TerceiroCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="Database" />
                            <TextBlock Text="TERCEIRO" />
                        </StackPanel>
                    </Button>

                    <Button
                        Margin="0,0,0,5"
                        Command="{Binding QuartoCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="School" />
                            <TextBlock Text="QUARTO" />
                        </StackPanel>
                    </Button>

                    <Button
                        Margin="0,0,0,5"
                        Command="{Binding QuintoCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="ViewDashboard" />
                            <TextBlock Text="QUINTO" />
                        </StackPanel>
                    </Button>

                    <Button
                        Margin="0,0,0,15"
                        Command="{Binding SextoCommand}"
                        Style="{StaticResource ActionButton}"
                        >
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,8,0" Kind="Target" />
                            <TextBlock Text="SEXTO" />
                        </StackPanel>
                    </Button>

                    <!--  Separador  -->
                    <Separator Margin="0,0,0,15" Background="{StaticResource BorderBrush}" />

                    <!--  Título Fase 1  -->
                    <TextBlock
                        Margin="0,0,0,10"
                        HorizontalAlignment="Center"
                        FontSize="12"
                        FontWeight="Bold"
                        Foreground="{StaticResource AccentTextBrush}"
                        Text="🚀 FASE 1 - NOVO"
                        />

                    <!--  Botões da Fase 1 em Grid 2x2  -->
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Gerar Palpite Novo  -->
                        <Button
                            Grid.Row="0"
                            Grid.Column="0"
                            Margin="0,0,2,2"
                            Background="{StaticResource PalpiteButtonBrush}"
                            Command="{Binding GerarPalpiteNovoCommand}"
                            Style="{StaticResource SidePanelButton}"
                            >
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <md:PackIcon FontSize="16" Kind="AutoFix" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="Palpite"
                                    />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="Novo"
                                    />
                            </StackPanel>
                        </Button>

                        <!--  Diagnósticos  -->
                        <Button
                            Grid.Row="0"
                            Grid.Column="1"
                            Margin="2,0,0,2"
                            Background="{StaticResource DiagnosticButtonBrush}"
                            Command="{Binding ExecutarDiagnosticosCommand}"
                            Style="{StaticResource SidePanelButton}"
                            >
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <md:PackIcon FontSize="16" Kind="BugCheck" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="Diagnós-"
                                    />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="tico"
                                    />
                            </StackPanel>
                        </Button>

                        <!--  Validar Fase 1  -->
                        <Button
                            Grid.Row="1"
                            Grid.Column="0"
                            Margin="0,2,2,0"
                            Background="{StaticResource ValidationButtonBrush}"
                            Command="{Binding ValidarFase1Command}"
                            Style="{StaticResource SidePanelButton}"
                            >
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <md:PackIcon FontSize="16" Kind="CheckCircle" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="Validar"
                                    />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="F1"
                                    />
                            </StackPanel>
                        </Button>

                        <!--  Comparar Performance  -->
                        <Button
                            Grid.Row="1"
                            Grid.Column="1"
                            Margin="2,2,0,0"
                            Background="{StaticResource ComparisonButtonBrush}"
                            Command="{Binding CompararPerformanceCommand}"
                            Style="{StaticResource SidePanelButton}"
                            >
                            <StackPanel HorizontalAlignment="Center" Orientation="Vertical">
                                <md:PackIcon FontSize="16" Kind="Compare" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="Compa-"
                                    />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="9"
                                    Text="rar"
                                    />
                            </StackPanel>
                        </Button>
                    </Grid>

                </StackPanel>
            </ScrollViewer>
        </Border>

        <!--  ==================================  -->
        <!--  PAINEL CENTRAL SUPERIOR - STATUS PREDICTION ENGINE  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="1"
            Grid.Column="1"
            Margin="5,10,5,5"
            Background="{StaticResource PrimaryBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="8"
            >

            <StackPanel Margin="15">
                <TextBlock
                    Margin="0,0,0,15"
                    HorizontalAlignment="Center"
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="{StaticResource PrimaryTextBrush}"
                    Text="🚀 PREDICTION ENGINE - FASE 1"
                    />

                <!--  Status do Engine  -->
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        VerticalAlignment="Center"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Status:"
                        />

                    <TextBlock
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        FontFamily="{StaticResource MonospaceFontFamily}"
                        FontSize="11"
                        Foreground="{Binding IsPredictionEngineInitialized, Converter={StaticResource BoolToColorConverter}}"
                        Text="{Binding PredictionEngineStatus}"
                        TextWrapping="Wrap"
                        />
                </Grid>

                <!--  Última Predição  -->
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        VerticalAlignment="Top"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Última:"
                        />

                    <TextBlock
                        Grid.Column="1"
                        MaxHeight="50"
                        Margin="10,0,0,0"
                        FontFamily="{StaticResource MonospaceFontFamily}"
                        FontSize="10"
                        Foreground="{StaticResource AccentTextBrush}"
                        Text="{Binding LastPredictionResult}"
                        TextWrapping="Wrap"
                        />
                </Grid>

                <!--  Status de Validação  -->
                <Grid Margin="0,0,0,10" Visibility="{Binding IsValidationRunning, Converter={StaticResource BoolToVisibilityConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        VerticalAlignment="Center"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Validação:"
                        />

                    <TextBlock
                        Grid.Column="1"
                        Margin="10,0,0,0"
                        FontFamily="{StaticResource MonospaceFontFamily}"
                        FontSize="10"
                        Foreground="{StaticResource WarningBrush}"
                        Text="{Binding Phase1ValidationStatus}"
                        TextWrapping="Wrap"
                        />
                </Grid>

            </StackPanel>
        </Border>

        <!--  ==================================  -->
        <!--  PAINEL CENTRAL INFERIOR - MÉTRICAS FASE 1  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="2"
            Grid.Column="1"
            Margin="5,5,5,10"
            Background="{StaticResource SecondaryBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="8"
            >

            <StackPanel Margin="15">
                <TextBlock
                    Margin="0,0,0,15"
                    HorizontalAlignment="Center"
                    FontSize="14"
                    FontWeight="Bold"
                    Foreground="{StaticResource PrimaryTextBrush}"
                    Text="📊 MÉTRICAS - FASE 1"
                    />

                <!--  Grid de Métricas  -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <!--  Arquitetura  -->
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="0"
                        Margin="0,0,0,5"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Arquitetura:"
                        />
                    <TextBlock
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="0,0,0,5"
                        FontSize="11"
                        Foreground="{StaticResource SuccessBrush}"
                        Text="✅ Refatorada"
                        />

                    <!--  Interfaces  -->
                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="0,0,0,5"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Interfaces:"
                        />
                    <TextBlock
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="0,0,0,5"
                        FontSize="11"
                        Foreground="{StaticResource SuccessBrush}"
                        Text="✅ Implementadas"
                        />

                    <!--  Bug Fix  -->
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="0"
                        Margin="0,0,0,5"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="Bug Dezenas 1-9:"
                        />
                    <TextBlock
                        Grid.Row="2"
                        Grid.Column="1"
                        Margin="0,0,0,5"
                        FontSize="11"
                        Foreground="{StaticResource WarningBrush}"
                        Text="🎯 Em análise"
                        />

                    <!--  Engine Status  -->
                    <TextBlock
                        Grid.Row="3"
                        Grid.Column="0"
                        Margin="0,0,0,5"
                        FontWeight="SemiBold"
                        Foreground="{StaticResource SecondaryTextBrush}"
                        Text="PredictionEngine:"
                        />
                    <TextBlock
                        Grid.Row="3"
                        Grid.Column="1"
                        Margin="0,0,0,5"
                        FontSize="11"
                        Foreground="{Binding IsPredictionEngineInitialized, Converter={StaticResource BoolToColorConverter}}"
                        Text="{Binding IsPredictionEngineInitialized, Converter={StaticResource BoolToYesNoConverter}}"
                        />

                </Grid>
            </StackPanel>
        </Border>

        <!--  ==================================  -->
        <!--  PAINEL DIREITO - AÇÕES AUXILIARES  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="2"
            Margin="5,10,10,10"
            Background="{StaticResource SecondaryBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="8"
            >

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">

                    <!--  Título da Seção  -->
                    <TextBlock
                        Margin="0,0,0,15"
                        HorizontalAlignment="Center"
                        FontSize="14"
                        FontWeight="Bold"
                        Foreground="{StaticResource PrimaryTextBrush}"
                        Text="⚙️ AÇÕES AUXILIARES"
                        />

                    <!--  Botões Auxiliares  -->
                    <Button Command="{Binding DezCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric10BoxOutline" />
                            <TextBlock Text="DEZ" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding OnzeCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="ChartBox" />
                            <TextBlock Text="BASEADO" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding DozeCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric1BoxOutline" />
                            <TextBlock Text="DOZE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding TrezeCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric2BoxOutline" />
                            <TextBlock Text="TREZE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding QuatorzeCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric3BoxOutline" />
                            <TextBlock Text="QUATORZE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding QuinzeCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric4BoxOutline" />
                            <TextBlock Text="QUINZE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding DezesseisCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric5BoxOutline" />
                            <TextBlock Text="DEZESSEIS" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding DezesseteCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric6BoxOutline" />
                            <TextBlock Text="DEZESSETE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding DezoitoCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric7BoxOutline" />
                            <TextBlock Text="DEZOITO" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding DezenoveCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="Numeric8BoxOutline" />
                            <TextBlock Text="DEZENOVE" />
                        </StackPanel>
                    </Button>

                    <Button Command="{Binding VinteCommand}" Style="{StaticResource SidePanelButton}">
                        <StackPanel Orientation="Horizontal">
                            <md:PackIcon Margin="0,0,5,0" Kind="ChartLineStacked" />
                            <TextBlock Text="VINTE" />
                        </StackPanel>
                    </Button>

                    <!--  Separador  -->
                    <Separator Margin="0,20,0,10" Background="{StaticResource BorderBrush}" />

                    <!--  Campo de texto para concurso  -->
                    <TextBox
                        x:Name="txtConcurso"
                        Margin="0,10"
                        md:HintAssist.Hint="Número do concurso"
                        Foreground="{StaticResource PrimaryTextBrush}"
                        Style="{StaticResource Phase1TextBox}"
                        Text="{Binding TextoConcurso, UpdateSourceTrigger=PropertyChanged}"
                        />

                </StackPanel>
            </ScrollViewer>
        </Border>

        <!--  ==================================  -->
        <!--  ÁREA CENTRAL PARA OSCILADORES (QUANDO VISÍVEL)  -->
        <!--  ==================================  -->
        <Border
            Grid.Row="1"
            Grid.RowSpan="2"
            Grid.Column="1"
            Margin="5,10,5,10"
            Background="White"
            CornerRadius="10"
            Visibility="{Binding MostrarOsciladores, Converter={StaticResource BoolToVisibilityConverter}}"
            >

            <ScrollViewer>
                <ItemsControl ItemsSource="{Binding DezenasOscilantes}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel HorizontalAlignment="Center" Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <local:DezenaOscilanteControl Margin="4" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

    </Grid>
</Window>
